<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Trunk disease management options decision tool</title>
<meta name=viewport content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="css/all.css" />
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
</head>

<body id="page">

<header>
	<div class="header-wrap">
		<h1 class="title" role="title">Trunk disease management options decision tool</h1>
		<h1 class="images">
			<img src="images/header-photo-center.jpg" alt="Photo: Esca" />
			<img src="images/header-photo-right.jpg" alt="Photo: Eutypa dieback" />
			<img src="images/header-photo-extended01.jpg" alt="Photo: Phomopsis dieback" />
			<img src="images/header-photo-extended02.jpg" alt="Photo: Eutypa dieback" />
			<img src="images/header-photo-extended03.jpg" alt="Photo: Bot dieback" />
		</h1>
	</div>
</header>

<section class="content-wrap">

<fieldset>
<h2 id="introduction">Introduction</h2>

<p>Trunk (or wood-canker) diseases are widespread throughout California. These diseases significantly reduce annual yield in mature vineyards, limiting their profitable lifespan. Estimates suggest annual losses in California vineyards from Eutypa dieback, a widespread wood-canker disease, reduce annual gross producer value by as much as 14%. Yield losses accumulate each year, as there are no effective methods to eradicate the wood infections. Diseased vineyards must be replanted on a truncated cycle, and the high start-up costs are not repaid, or preventative practices can be adopted in young vineyards reducing the negative effects of trunk diseases. On this page we provide results from our economic analysis that demonstrate the effectiveness of three field-tested, preventative practices (delayed pruning, double pruning, and application of pruning wound protectant. This page also provides growers an opportunity to enter economic and yield data for their operation to see how trunk diseases and these preventative practices might affect production in their winegrape vineyard.</p>

<h3 id="instructions">Instructions</h3>

<p>In the following section of this page, you are prompted to select a winegrape growing region, figures of annually and cumulative net returns and yields, and tables containing annually average and cumulatively economic indicators taken from our economic analysis. You will also be prompted to select the preventative practices, disease control efficacy rates, and vineyard age when a preventative practice is first adopted. You will also find links to description of the preventative practices and disease control efficacy rates, definitions of the variables displayed in the figures and tables, and the form for you to enter your own data. All figure and table displays list the underlying region-specific assumptions used in the economic analysis.</p>

<p>For inquiries about the page and economic analysis of trunk diseases in California winegrape vineyards, please contact <a href="&#109;&#97;&#105;&#108;&#x74;&#111;&#x3a;&#x6b;&#x61;&#112;&#x6c;&#x61;&#x6e;&#x6a;&#64;&#99;&#115;&#117;&#115;&#46;&#101;&#100;&#x75;">&#107;&#97;&#x70;&#x6c;&#x61;&#x6e;&#106;&#x40;&#x63;&#115;&#117;&#115;&#x2e;&#101;&#x64;&#x75;</a>. </p>

<ul>
<li><a href="http://treeandvinetrunkdiseases.org">SCRI Trunk Disease Project Page</a></li>
</ul>
</fieldset>

<form action="" id="theform">

	<label><strong>Vineyard region: </strong><select name="region">
		<option value="nsj">Northern San Joaquin</option>
		<option value="napa">Napa</option>
		<option value="lake">Lake</option>
		<option value="sonoma">Sonoma</option>
		<option value="cc">Central Coast</option>
	</select>

	<h3 id="figureparameters">Figure parameters</h3>
	<label><input type="checkbox" name="figuregen" checked="checked" />Generate figure</label>

	<fieldset class="figure">

		<h4>Specify figure options</h5>

		<p class="glossary-link"><a href="variable-definitions.html">Glossary of variable definitions</a></p>

		<h5>Display output as:</h5>
			<label><input type="radio" name="figuredisplay" value="netreturns" checked />Net returns <span class="show-for-medium-up">(thousands of $ per acre; aggregate output cumulatively)</span></label>
			<label><input type="radio" name="figuredisplay" value="yield" />Yield <span class="show-for-medium-up">(tons per acre; aggregate output annually)</span></label>

		<!--<h5>Aggregate output:</h5>
			<label><input type="radio" name="aggregatefig" value="cumulatively" checked="checked" />Cumulatively</label>
			<label><input type="radio" name="aggregatefig" value="annually" />Annually</label>-->
		
		<h4>Specify management scenario</h4>

		<p class="glossary-link"><a href="practice-definitions.html">Glossary of practice definitions</a></p>

		<h5>Select the management practices to consider:</h5>
			<label><input type="checkbox" name="practicefig" value="dp" />Delayed pruning</label>
			<label><input type="checkbox" name="practicefig" value="hp" />Hand-painted TopsinM</label>
			<label><input type="checkbox" name="practicefig" value="dbp" />Double pruning</label>
		<h5>Select (a) or (b).</h5>
		<h5><label><input type="radio" name="efficacyOrYearfig" value="efficacy" /> (a) Indicate anticipated efficacy:</label></h5>
		<p class="glossary-link"><a href="efficacy-information.html">Disease control efficacy definition and reference estimates</a></p>
			<label><input type="checkbox" name="efficacyfig" value="25" />25%</label>
			<label><input type="checkbox" name="efficacyfig" value="50" />50%</label>
			<label><input type="checkbox" name="efficacyfig" value="75" />75%</label>
		<h5><label><input type="radio" name="efficacyOrYearfig" value="year" /> (b) Indicate first year of treatment:</label></h5>
			<label><input type="checkbox" name="yearfig" value="Year3" />Year 3</label>
			<label><input type="checkbox" name="yearfig" value="Year5" />Year 5</label>
			<label><input type="checkbox" name="yearfig" value="Year10" />Year 10</label>

	</fieldset>

	<h3 id="tableparameters">Table parameters</h3>
	<label><input type="checkbox" name="tablegen" checked="checked" />Generate table</label>

	<fieldset class="table management">
		
		<h4>Specify management scenario </h4>

		<h5>Select the management practices to consider (select multiple to compare):</h5>
			<label><input type="checkbox" name="practicetable" value="dp" checked="checked" />Delayed pruning</label>
			<label><input type="checkbox" name="practicetable" value="hp" />Hand-painted TopsinM</label>
			<label><input type="checkbox" name="practicetable" value="dbp" />Double pruning</label>
		<h5>Select anticipated efficacy (select multiple to compare):</h5>
			<label><input type="checkbox" name="efficacytable" value="25" checked="checked" />25%</label>
			<label><input type="checkbox" name="efficacytable" value="50" />50%</label>
			<label><input type="checkbox" name="efficacytable" value="75" />75%</label>

		<h5>Select year of practice adoption (select multiple to compare):</h5>
			<label><input type="checkbox" name="adoptiontable" value="3" />Year 3</label>
			<label><input type="checkbox" name="adoptiontable" value="5" />Year 5</label>
			<label><input type="checkbox" name="adoptiontable" value="10" />Year 10</label>

		<h5>Choose output parameters:</h5>
			<p><a href="variable-definitions.html">Glossary of variable definitions</a></p>
			<label><input type="checkbox" name="outputtable" value="dcnr" />Discounted cumulative net returns</label><br />
			<label><input type="checkbox" name="outputtable" value="aanr" />Annual average net returns</label><br />
			<label><input type="checkbox" name="outputtable" value="lpy" />Last profitable year</label><br />
			<label><input type="checkbox" name="outputtable" value="bea" />Breakeven age</label><br />

	</fieldset>

	<input type="submit" value="Display returns to this practice" />

</form>

<section id="results" class="results"></section>

<hr />

<p><a href="#page" onclick="$('body').stop().animate({scrollTop: $('#page').offset().top - $('header').height()}, '500', 'swing');">&#8593; Top</a></p>
</section>

</section>

<script type="text/javascript">
$(document).ready(function() {
	/***** FORM TOGGLE OPTIONS
	------------------------------------ */
		
		/***** Toggle input options available to net returns vs yield
		------------------------------------ */

		/* $('input[name=figuredisplay]').change(function() {
			if (this.value == 'netreturns') {
				$('input[name=aggregatefig]').each(function() {
					$(this).prop('disabled', false).prop('checked', false);
				});
				$('input[name=aggregatefig][value=cumulatively]').prop('checked', true);
				$('input[name=practicefig]').each(function() {
					$(this).prop('disabled', false);
				});
			}
			else if (this.value == 'yield') {
				$('input[name=practicefig]').each(function() {
					$(this).prop('disabled', true);
				});
				$('input[name=aggregatefig][value=annually]').prop('checked', true).prop('disabled', true);
				$('input[name=aggregatefig][value=cumulatively').prop('disabled', true);
			}
		}); */

		/***** Toggle input options when gentable, genfigure are switched on/off
		------------------------------------ */

		var figurestate = new Boolean(true);
		var tablestate = new Boolean(true);

		$('input[name=figuregen]').change(function() {
			figurestate = $(this).prop('checked');
			$('fieldset.figure').each(function() {
				$(this).prop('disabled', !figurestate);
			});
		});
		$('input[name=tablegen]').change(function() {
			tablestate = $(this).prop('checked');
			$('fieldset.table').each(function() {
				$(this).prop('disabled', !tablestate);
			});
		});

		/***** Toggle input options when choosing between efficacy and year vars for figure
		------------------------------------ */

		var efficacyOrYearchoice = '';
		$('input[name=efficacyOrYearfig]').change(function() {
			efficacyOrYearchoice = $(this).val() + 'fig';
			var efficacyOrYeardisabledvar;
			switch (efficacyOrYearchoice) {
				case 'efficacyfig':
					efficacyOrYeardisabledvar = 'yearfig';
					break;
				default:
					efficacyOrYeardisabledvar = 'efficacyfig';
			}
			$('input[name=' + efficacyOrYearchoice + ']').each(function() {
				$(this).prop('disabled', false);
			});
			$('input[name=' + efficacyOrYeardisabledvar + ']').each(function() {
				$(this).prop('disabled', true);
			});
		});
		var efficacyOrYearselected = new Boolean(false);
		$('input[name=efficacyfig]').one('change', function() {
			if (efficacyOrYearselected==false) {
				efficacyOrYearselected = true;
				$('input[name=efficacyOrYearfig][value=efficacy]').attr('checked', true).change();
			};
		});
		$('input[name=yearfig]').one('change', function() {
			if (efficacyOrYearselected==false) {
				efficacyOrYearselected = true;
				$('input[name=efficacyOrYearfig][value=year]').attr('checked', true).change();
			}
		});	

	/***** FORM SUBMIT FUNCTION
	------------------------------------ */
	$('#theform').submit(function(e) {
		e.preventDefault();

		/***** Generate figure(s)
		------------------------------------ */
		var fullfig = '';
		var efficacyOrYearlength;
		switch (efficacyOrYearchoice) {
			case 'efficacyfig':
				efficacyOrYearlength=$('input[name=efficacyfig]:checked').length;
				break;
			default:
				efficacyOrYearlength=$('input[name=yearfig]:checked').length;
				break;			
		};

		if (efficacyOrYearlength==0 || (efficacyOrYearchoice==0 && $('input[name=practicefig]:checked').length==0) ) {
			fullfig = '<p class="alert">The <em>Generate figure</em> option is selected, but insufficient parameters were selected to produce a figure. To generate a figure, please return to the <a href="#" onclick="console.log(\'click\'); $(\'body\').stop().animate({scrollTop: $(\'#figureparameters\').offset().top - $(\'header\').height()}, \'500\', \'swing\'); return false;">figure parameters form</a> and select an efficacy level or a year of adoption, and for a net returns figure, at least one management practice.</p>';

		} else {

			switch ( $('input[name=figuredisplay]:checked').val() ) {
				case 'yield':
					var efficacyOrYearfig = [];
					var fig = [];
					for (var j=0; j<efficacyOrYearlength; j++) {
						efficacyOrYearfig[j] = $('input[name=' + efficacyOrYearchoice + ']:checked:eq('+j+')').val();
						fig[j] =  '<img src="images/figures/' + $('select[name=region]').val().toUpperCase() + '-' + 'Yield' + efficacyOrYearfig[j] + '.png" style="width: 910px;" alt="Graphical result" />'
						fullfig += fig[j];
					}
					break;
				case 'netreturns':
					var efficacyOrYearfig = [];
					var practicefig = [];
					var fig = [];
					for (var i=0; i<$('input[name=practicefig]:checked').length; i++) {
						practicefig[i] = $('input[name=practicefig]:checked:eq('+i+')').val();
						for (var j=0; j<efficacyOrYearlength; j++) {
							efficacyOrYearfig[j] = $('input[name=' + efficacyOrYearchoice + ']:checked:eq('+j+')').val();
							fig[i*$('input[name=practicefig]:checked').length+j] =  '<img src="images/figures/' + $('select[name=region]').val().toUpperCase() + '-' + practicefig[i].toUpperCase() + efficacyOrYearfig[j] + '.png" style="width: 910px;" alt="Graphical result" />'
							fullfig += fig[i*$('input[name=practicefig]:checked').length+j];
						}
					}
					break;
			};
		};

		/***** Generate table
		------------------------------------ */

			// Declare table data
			var tableHeaders = ['Region', 'Practice', 'Efficacy', 'Year of adoption', 'DCNR', 'Annual average net returns', 'Last profitable year', 'Breakeven age'];

			var ccDP25y3 = ['Central Coast', 'Delayed Pruning', '25.0', '3.0', '$12,841.00', '$513.64', '17','3'];
			var ccDP25y5 = ['Central Coast', 'Delayed Pruning', '25.0', '5.0', '$10,417.00', '$416.68', '14','5'];
			var ccDP25y10 = ['Central Coast', 'Delayed Pruning', '25.0', '10.0', '$4,444.00', '$177.76', '13','10'];
			var ccDP50y3 = ['Central Coast', 'Delayed Pruning', '50.0', '3.0', '$31,524.00', '$1,260.96', '24','3'];
			var ccDP50y5 = ['Central Coast', 'Delayed Pruning', '50.0', '5.0', '$26,659.00', '$1,066.36', '22','5'];
			var ccDP50y10 = ['Central Coast', 'Delayed Pruning', '50.0', '10.0', '$12,156.00', '$486.24', '17','10'];
			var ccDP75y3 = ['Central Coast', 'Delayed Pruning', '75.0', '3.0', '$42,690.00', '$1,707.60', '25','3'];
			var ccDP75y5 = ['Central Coast', 'Delayed Pruning', '75.0', '5.0', '$40,531.00', '$1,621.24', '25','5'];
			var ccDP75y10 = ['Central Coast', 'Delayed Pruning', '75.0', '10.0', '$24,712.00', '$988.48', '25','10'];
			var ccDBP25y3 = ['Central Coast', 'Double Pruning', '25.0', '3.0', '$7,276.00', '$291.04', '16','12'];
			var ccDBP25y5 = ['Central Coast', 'Double Pruning', '25.0', '5.0', '$5,500.00', '$220.00', '16','12'];
			var ccDBP25y10 = ['Central Coast', 'Double Pruning', '25.0', '10.0', '$988.00', '$39.52', '14','13'];
			var ccDBP50y3 = ['Central Coast', 'Double Pruning', '50.0', '3.0', '$25,959.00', '$1,038.36', '24','11'];
			var ccDBP50y5 = ['Central Coast', 'Double Pruning', '50.0', '5.0', '$21,742.00', '$869.68', '21','11'];
			var ccDBP50y10 = ['Central Coast', 'Double Pruning', '50.0', '10.0', '$8,700.00', '$348.00', '17','11'];
			var ccDBP75y3 = ['Central Coast', 'Double Pruning', '75.0', '3.0', '$37,126.00', '$1,485.04', '25','10'];
			var ccDBP75y5 = ['Central Coast', 'Double Pruning', '75.0', '5.0', '$35,614.00', '$1,424.56', '25','10'];
			var ccDBP75y10 = ['Central Coast', 'Double Pruning', '75.0', '10.0', '$21,256.00', '$850.24', '25','10'];
			var ccHP25y3 = ['Central Coast', 'Hand painted Topsin', '25.0', '3.0', '$11,725.00', '$469.00', '17','8'];
			var ccHP25y5 = ['Central Coast', 'Hand painted Topsin', '25.0', '5.0', '$9,431.00', '$377.24', '16','8'];
			var ccHP25y10 = ['Central Coast', 'Hand painted Topsin', '25.0', '10.0', '$3,751.00', '$150.04', '14','10'];
			var ccHP50y3 = ['Central Coast', 'Hand painted Topsin', '50.0', '3.0', '$30,408.00', '$1,216.32', '24','7'];
			var ccHP50y5 = ['Central Coast', 'Hand painted Topsin', '50.0', '5.0', '$25,673.00', '$1,026.92', '22','7'];
			var ccHP50y10 = ['Central Coast', 'Hand painted Topsin', '50.0', '10.0', '$11,463.00', '$458.52', '17','10'];
			var ccHP75y3 = ['Central Coast', 'Hand painted Topsin', '75.0', '3.0', '$41,574.00', '$1,662.96', '25','7'];
			var ccHP75y5 = ['Central Coast', 'Hand painted Topsin', '75.0', '5.0', '$39,545.00', '$1,581.80', '25','7'];
			var ccHP75y10 = ['Central Coast', 'Hand painted Topsin', '75.0', '10.0', '$24,019.00', '$960.76', '25','10'];
			var sonomaDP25y3 = ['Sonoma', 'Delayed Pruning', '25.0', '3.0', '$24,303.00', '$972.12', '16','3'];
			var sonomaDP25y5 = ['Sonoma', 'Delayed Pruning', '25.0', '5.0', '$19,706.00', '$788.24', '15','5'];
			var sonomaDP25y10 = ['Sonoma', 'Delayed Pruning', '25.0', '10.0', '$8,406.00', '$336.24', '13','10'];
			var sonomaDP50y3 = ['Sonoma', 'Delayed Pruning', '50.0', '3.0', '$59,655.00', '$2,386.20', '23','3'];
			var sonomaDP50y5 = ['Sonoma', 'Delayed Pruning', '50.0', '5.0', '$50,432.00', '$2,017.28', '21','5'];
			var sonomaDP50y10 = ['Sonoma', 'Delayed Pruning', '50.0', '10.0', '$22,996.00', '$919.84', '16','10'];
			var sonomaDP75y3 = ['Sonoma', 'Delayed Pruning', '75.0', '3.0', '$80,786.00', '$3,231.44', '25','3'];
			var sonomaDP75y5 = ['Sonoma', 'Delayed Pruning', '75.0', '5.0', '$76,674.00', '$3,066.96', '25','5'];
			var sonomaDP75y10 = ['Sonoma', 'Delayed Pruning', '75.0', '10.0', '$46,748.00', '$1,869.92', '23','10'];
			var sonomaDBP25y3 = ['Sonoma', 'Double Pruning', '25.0', '3.0', '$19,110.00', '$764.40', '15','10'];
			var sonomaDBP25y5 = ['Sonoma', 'Double Pruning', '25.0', '5.0', '$15,118.00', '$604.72', '15','10'];
			var sonomaDBP25y10 = ['Sonoma', 'Double Pruning', '25.0', '10.0', '$5,181.00', '$207.24', '13','11'];
			var sonomaDBP50y3 = ['Sonoma', 'Double Pruning', '50.0', '3.0', '$54,462.00', '$2,178.48', '22','9'];
			var sonomaDBP50y5 = ['Sonoma', 'Double Pruning', '50.0', '5.0', '$45,844.00', '$1,833.76', '20','9'];
			var sonomaDBP50y10 = ['Sonoma', 'Double Pruning', '50.0', '10.0', '$19,771.00', '$790.84', '15','10'];
			var sonomaDBP75y3 = ['Sonoma', 'Double Pruning', '75.0', '3.0', '$75,594.00', '$3,023.76', '25','9'];
			var sonomaDBP75y5 = ['Sonoma', 'Double Pruning', '75.0', '5.0', '$72,086.00', '$2,883.44', '25','9'];
			var sonomaDBP75y10 = ['Sonoma', 'Double Pruning', '75.0', '10.0', '$43,523.00', '$1,740.92', '22','10'];
			var sonomaHP25y3 = ['Sonoma', 'Hand painted Topsin', '25.0', '3.0', '$23,388.00', '$935.52', '15','6'];
			var sonomaHP25y5 = ['Sonoma', 'Hand painted Topsin', '25.0', '5.0', '$18,898.00', '$755.92', '15','6'];
			var sonomaHP25y10 = ['Sonoma', 'Hand painted Topsin', '25.0', '10.0', '$7,838.00', '$313.52', '13','10'];
			var sonomaHP50y3 = ['Sonoma', 'Hand painted Topsin', '50.0', '3.0', '$58,740.00', '$2,349.60', '22','6'];
			var sonomaHP50y5 = ['Sonoma', 'Hand painted Topsin', '50.0', '5.0', '$49,624.00', '$1,984.96', '20','6'];
			var sonomaHP50y10 = ['Sonoma', 'Hand painted Topsin', '50.0', '10.0', '$22,428.00', '$897.12', '15','10'];
			var sonomaHP75y3 = ['Sonoma', 'Hand painted Topsin', '75.0', '3.0', '$79,872.00', '$3,194.88', '25','5'];
			var sonomaHP75y5 = ['Sonoma', 'Hand painted Topsin', '75.0', '5.0', '$75,866.00', '$3,034.64', '25','5'];
			var sonomaHP75y10 = ['Sonoma', 'Hand painted Topsin', '75.0', '10.0', '$46,180.00', '$1,847.20', '22','10'];
			var lakeDP25y3 = ['Lake', 'Delayed Pruning', '25.0', '3.0', '$8,723.00', '$348.92', '15','3'];
			var lakeDP25y5 = ['Lake', 'Delayed Pruning', '25.0', '5.0', '$7,077.00', '$283.08', '15','5'];
			var lakeDP25y10 = ['Lake', 'Delayed Pruning', '25.0', '10.0', '$3,019.00', '$120.76', '13','10'];
			var lakeDP50y3 = ['Lake', 'Delayed Pruning', '50.0', '3.0', '$21,416.00', '$856.64', '22','3'];
			var lakeDP50y5 = ['Lake', 'Delayed Pruning', '50.0', '5.0', '$18,111.00', '$724.44', '20','5'];
			var lakeDP50y10 = ['Lake', 'Delayed Pruning', '50.0', '10.0', '$8,258.00', '$330.32', '15','10'];
			var lakeDP75y3 = ['Lake', 'Delayed Pruning', '75.0', '3.0', '$29,002.00', '$1,160.08', '25','3'];
			var lakeDP75y5 = ['Lake', 'Delayed Pruning', '75.0', '5.0', '$27,535.00', '$1,101.40', '25','5'];
			var lakeDP75y10 = ['Lake', 'Delayed Pruning', '75.0', '10.0', '$16,788.00', '$671.52', '22','10'];
			var lakeDBP25y3 = ['Lake', 'Double Pruning', '25.0', '3.0', '$5,763.00', '$230.52', '15','11'];
			var lakeDBP25y5 = ['Lake', 'Double Pruning', '25.0', '5.0', '$4,461.00', '$178.44', '14','11'];
			var lakeDBP25y10 = ['Lake', 'Double Pruning', '25.0', '10.0', '$1,180.00', '$47.20', '13','12'];
			var lakeDBP50y3 = ['Lake', 'Double Pruning', '50.0', '3.0', '$18,455.00', '$738.20', '22','10'];
			var lakeDBP50y5 = ['Lake', 'Double Pruning', '50.0', '5.0', '$15,495.00', '$619.80', '20','10'];
			var lakeDBP50y10 = ['Lake', 'Double Pruning', '50.0', '10.0', '$6,419.00', '$256.76', '15','11'];
			var lakeDBP75y3 = ['Lake', 'Double Pruning', '75.0', '3.0', '$26,041.00', '$1,041.64', '25','10'];
			var lakeDBP75y5 = ['Lake', 'Double Pruning', '75.0', '5.0', '$24,919.00', '$996.76', '25','10'];
			var lakeDBP75y10 = ['Lake', 'Double Pruning', '75.0', '10.0', '$14,949.00', '$597.96', '21','10'];
			var lakeHP25y3 = ['Lake', 'Hand painted Topsin', '25.0', '3.0', '$7,855.00', '$314.20', '15','9'];
			var lakeHP25y5 = ['Lake', 'Hand painted Topsin', '25.0', '5.0', '$6,310.00', '$252.40', '15','9'];
			var lakeHP25y10 = ['Lake', 'Hand painted Topsin', '25.0', '10.0', '$2,480.00', '$99.20', '13','10'];
			var lakeHP50y3 = ['Lake', 'Hand painted Topsin', '50.0', '3.0', '$20,548.00', '$821.92', '22','8'];
			var lakeHP50y5 = ['Lake', 'Hand painted Topsin', '50.0', '5.0', '$17,344.00', '$693.76', '20','8'];
			var lakeHP50y10 = ['Lake', 'Hand painted Topsin', '50.0', '10.0', '$7,719.00', '$308.76', '15','10'];
			var lakeHP75y3 = ['Lake', 'Hand painted Topsin', '75.0', '3.0', '$28,134.00', '$1,125.36', '25','7'];
			var lakeHP75y5 = ['Lake', 'Hand painted Topsin', '75.0', '5.0', '$26,768.00', '$1,070.72', '25','7'];
			var lakeHP75y10 = ['Lake', 'Hand painted Topsin', '75.0', '10.0', '$16,249.00', '$649.96', '22','10'];
			var nsjDP25y3 = ['Northern San Joaquin', 'Delayed Pruning', '25.0', '3.0', '$13,797.00', '$551.88', '14','3'];
			var nsjDP25y5 = ['Northern San Joaquin', 'Delayed Pruning', '25.0', '5.0', '$11,187.00', '$447.48', '14','5'];
			var nsjDP25y10 = ['Northern San Joaquin', 'Delayed Pruning', '25.0', '10.0', '$4,772.00', '$190.88', '12','10'];
			var nsjDP50y3 = ['Northern San Joaquin', 'Delayed Pruning', '50.0', '3.0', '$33,866.00', '$1,354.64', '21','3'];
			var nsjDP50y5 = ['Northern San Joaquin', 'Delayed Pruning', '50.0', '5.0', '$28,629.00', '$1,145.16', '19','5'];
			var nsjDP50y10 = ['Northern San Joaquin', 'Delayed Pruning', '50.0', '10.0', '$13,054.00', '$522.16', '14','10'];
			var nsjDP75y3 = ['Northern San Joaquin', 'Delayed Pruning', '75.0', '3.0', '$45,863.00', '$1,834.52', '25','3'];
			var nsjDP75y5 = ['Northern San Joaquin', 'Delayed Pruning', '75.0', '5.0', '$43,525.00', '$1,741.00', '25','5'];
			var nsjDP75y10 = ['Northern San Joaquin', 'Delayed Pruning', '75.0', '10.0', '$26,538.00', '$1,061.52', '19','10'];
			var nsjDBP25y3 = ['Northern San Joaquin', 'Double Pruning', '25.0', '3.0', '$9,566.00', '$382.64', '14','11'];
			var nsjDBP25y5 = ['Northern San Joaquin', 'Double Pruning', '25.0', '5.0', '$7,448.00', '$297.92', '13','11'];
			var nsjDBP25y10 = ['Northern San Joaquin', 'Double Pruning', '25.0', '10.0', '$2,144.00', '$85.76', '12','12'];
			var nsjDBP50y3 = ['Northern San Joaquin', 'Double Pruning', '50.0', '3.0', '$29,635.00', '$1,185.40', '20','10'];
			var nsjDBP50y5 = ['Northern San Joaquin', 'Double Pruning', '50.0', '5.0', '$24,890.00', '$995.60', '18','10'];
			var nsjDBP50y10 = ['Northern San Joaquin', 'Double Pruning', '50.0', '10.0', '$10,426.00', '$417.04', '13','11'];
			var nsjDBP75y3 = ['Northern San Joaquin', 'Double Pruning', '75.0', '3.0', '$41,632.00', '$1,665.28', '25','11'];
			var nsjDBP75y5 = ['Northern San Joaquin', 'Double Pruning', '75.0', '5.0', '$39,786.00', '$1,591.44', '25','10'];
			var nsjDBP75y10 = ['Northern San Joaquin', 'Double Pruning', '75.0', '10.0', '$23,909.00', '$956.36', '18','11'];
			var nsjHP25y3 = ['Northern San Joaquin', 'Hand painted Topsin', '25.0', '3.0', '$12,425.00', '$497.00', '14','9'];
			var nsjHP25y5 = ['Northern San Joaquin', 'Hand painted Topsin', '25.0', '5.0', '$9,974.00', '$398.96', '14','9'];
			var nsjHP25y10 = ['Northern San Joaquin', 'Hand painted Topsin', '25.0', '10.0', '$3,920.00', '$156.80', '12','10'];
			var nsjHP50y3 = ['Northern San Joaquin', 'Hand painted Topsin', '50.0', '3.0', '$32,495.00', '$1,299.80', '21','8'];
			var nsjHP50y5 = ['Northern San Joaquin', 'Hand painted Topsin', '50.0', '5.0', '$27,417.00', '$1,096.68', '19','8'];
			var nsjHP50y10 = ['Northern San Joaquin', 'Hand painted Topsin', '50.0', '10.0', '$12,202.00', '$488.08', '14','10'];
			var nsjHP75y3 = ['Northern San Joaquin', 'Hand painted Topsin', '75.0', '3.0', '$44,491.00', '$1,779.64', '25','7'];
			var nsjHP75y5 = ['Northern San Joaquin', 'Hand painted Topsin', '75.0', '5.0', '$42,313.00', '$1,692.52', '25','7'];
			var nsjHP75y10 = ['Northern San Joaquin', 'Hand painted Topsin', '75.0', '10.0', '$25,686.00', '$1,027.44', '19','10'];
			var napaDP25y3 = ['Napa', 'Delayed Pruning', '25.0', '3.0', '$7,198.00', '$287.92', '18','3'];
			var napaDP25y5 = ['Napa', 'Delayed Pruning', '25.0', '5.0', '$5,836.00', '$233.44', '17','5'];
			var napaDP25y10 = ['Napa', 'Delayed Pruning', '25.0', '10.0', '$2,490.00', '$99.60', '15','10'];
			var napaDP50y3 = ['Napa', 'Delayed Pruning', '50.0', '3.0', '$17,669.00', '$706.76', '25','3'];
			var napaDP50y5 = ['Napa', 'Delayed Pruning', '50.0', '5.0', '$14,937.00', '$597.48', '24','5'];
			var napaDP50y10 = ['Napa', 'Delayed Pruning', '50.0', '10.0', '$6,811.00', '$272.44', '19','10'];
			var napaDP75y3 = ['Napa', 'Delayed Pruning', '75.0', '3.0', '$23,928.00', '$957.12', '25','3'];
			var napaDP75y5 = ['Napa', 'Delayed Pruning', '75.0', '5.0', '$22,709.00', '$908.36', '25','5'];
			var napaDP75y10 = ['Napa', 'Delayed Pruning', '75.0', '10.0', '$13,846.00', '$553.84', '25','10'];
			var napaDBP25y3 = ['Napa', 'Double Pruning', '25.0', '3.0', '$3,153.00', '$126.12', '17','13'];
			var napaDBP25y5 = ['Napa', 'Double Pruning', '25.0', '5.0', '$2,262.00', '$90.48', '16','13'];
			var napaDBP25y10 = ['Napa', 'Double Pruning', '25.0', '10.0', '$-23.00', '$-0.92', '14','14'];
			var napaDBP50y3 = ['Napa', 'Double Pruning', '50.0', '3.0', '$13,623.00', '$544.92', '24','12'];
			var napaDBP50y5 = ['Napa', 'Double Pruning', '50.0', '5.0', '$11,362.00', '$454.48', '22','11'];
			var napaDBP50y10 = ['Napa', 'Double Pruning', '50.0', '10.0', '$4,298.00', '$171.92', '17','12'];
			var napaDBP75y3 = ['Napa', 'Double Pruning', '75.0', '3.0', '$19,882.00', '$795.28', '25','12'];
			var napaDBP75y5 = ['Napa', 'Double Pruning', '75.0', '5.0', '$19,134.00', '$765.36', '25','11'];
			var napaDBP75y10 = ['Napa', 'Double Pruning', '75.0', '10.0', '$11,333.00', '$453.32', '25','10'];
			var napaHP25y3 = ['Napa', 'Hand painted Topsin', '25.0', '3.0', '$6,609.00', '$264.36', '17','8'];
			var napaHP25y5 = ['Napa', 'Hand painted Topsin', '25.0', '5.0', '$5,316.00', '$212.64', '17','8'];
			var napaHP25y10 = ['Napa', 'Hand painted Topsin', '25.0', '10.0', '$2,124.00', '$84.96', '15','10'];
			var napaHP50y3 = ['Napa', 'Hand painted Topsin', '50.0', '3.0', '$17,080.00', '$683.20', '25','7'];
			var napaHP50y5 = ['Napa', 'Hand painted Topsin', '50.0', '5.0', '$14,416.00', '$576.64', '23','7'];
			var napaHP50y10 = ['Napa', 'Hand painted Topsin', '50.0', '10.0', '$6,445.00', '$257.80', '18','10'];
			var napaHP75y3 = ['Napa', 'Hand painted Topsin', '75.0', '3.0', '$23,339.00', '$933.56', '25','7'];
			var napaHP75y5 = ['Napa', 'Hand painted Topsin', '75.0', '5.0', '$22,188.00', '$887.52', '25','7'];
			var napaHP75y10 = ['Napa', 'Hand painted Topsin', '75.0', '10.0', '$13,480.00', '$539.20', '25','10'];

			var ccDP25 = [ccDP25y3, ccDP25y5, ccDP25y10];
			var ccDP50 = [ccDP50y3, ccDP50y5, ccDP50y10];
			var ccDP75 = [ccDP75y3, ccDP75y5, ccDP75y10];
			var ccHP25 = [ccHP25y3, ccHP25y5, ccHP25y10];
			var ccHP50 = [ccHP50y3, ccHP50y5, ccHP50y10];
			var ccHP75 = [ccHP75y3, ccHP75y5, ccHP75y10];
			var ccDBP25 = [ccDBP25y3, ccDBP25y5, ccDBP25y10];
			var ccDBP50 = [ccDBP50y3, ccDBP50y5, ccDBP50y10];
			var ccDBP75 = [ccDBP75y3, ccDBP75y5, ccDBP75y10];
			var ccDP = [ccDP25, ccDP50, ccDP75];
			var ccHP = [ccHP25, ccHP50, ccHP75];
			var ccDBP = [ccDBP25, ccDBP50, ccDBP75];
			var cc = [ccDP, ccHP, ccDBP];

			var sonomaDP25 = [sonomaDP25y3, sonomaDP25y5, sonomaDP25y10];
			var sonomaDP50 = [sonomaDP50y3, sonomaDP50y5, sonomaDP50y10];
			var sonomaDP75 = [sonomaDP75y3, sonomaDP75y5, sonomaDP75y10];
			var sonomaHP25 = [sonomaHP25y3, sonomaHP25y5, sonomaHP25y10];
			var sonomaHP50 = [sonomaHP50y3, sonomaHP50y5, sonomaHP50y10];
			var sonomaHP75 = [sonomaHP75y3, sonomaHP75y5, sonomaHP75y10];
			var sonomaDBP25 = [sonomaDBP25y3, sonomaDBP25y5, sonomaDBP25y10];
			var sonomaDBP50 = [sonomaDBP50y3, sonomaDBP50y5, sonomaDBP50y10];
			var sonomaDBP75 = [sonomaDBP75y3, sonomaDBP75y5, sonomaDBP75y10];
			var sonomaDP = [sonomaDP25, sonomaDP50, sonomaDP75];
			var sonomaHP = [sonomaHP25, sonomaHP50, sonomaHP75];
			var sonomaDBP = [sonomaDBP25, sonomaDBP50, sonomaDBP75];
			var sonoma = [sonomaDP, sonomaHP, sonomaDBP];

			var lakeDP25 = [lakeDP25y3, lakeDP25y5, lakeDP25y10];
			var lakeDP50 = [lakeDP50y3, lakeDP50y5, lakeDP50y10];
			var lakeDP75 = [lakeDP75y3, lakeDP75y5, lakeDP75y10];
			var lakeHP25 = [lakeHP25y3, lakeHP25y5, lakeHP25y10];
			var lakeHP50 = [lakeHP50y3, lakeHP50y5, lakeHP50y10];
			var lakeHP75 = [lakeHP75y3, lakeHP75y5, lakeHP75y10];
			var lakeDBP25 = [lakeDBP25y3, lakeDBP25y5, lakeDBP25y10];
			var lakeDBP50 = [lakeDBP50y3, lakeDBP50y5, lakeDBP50y10];
			var lakeDBP75 = [lakeDBP75y3, lakeDBP75y5, lakeDBP75y10];
			var lakeDP = [lakeDP25, lakeDP50, lakeDP75];
			var lakeHP = [lakeHP25, lakeHP50, lakeHP75];
			var lakeDBP = [lakeDBP25, lakeDBP50, lakeDBP75];
			var lake = [lakeDP, lakeHP, lakeDBP];

			var nsjDP25 = [nsjDP25y3, nsjDP25y5, nsjDP25y10];
			var nsjDP50 = [nsjDP50y3, nsjDP50y5, nsjDP50y10];
			var nsjDP75 = [nsjDP75y3, nsjDP75y5, nsjDP75y10];
			var nsjHP25 = [nsjHP25y3, nsjHP25y5, nsjHP25y10];
			var nsjHP50 = [nsjHP50y3, nsjHP50y5, nsjHP50y10];
			var nsjHP75 = [nsjHP75y3, nsjHP75y5, nsjHP75y10];
			var nsjDBP25 = [nsjDBP25y3, nsjDBP25y5, nsjDBP25y10];
			var nsjDBP50 = [nsjDBP50y3, nsjDBP50y5, nsjDBP50y10];
			var nsjDBP75 = [nsjDBP75y3, nsjDBP75y5, nsjDBP75y10];
			var nsjDP = [nsjDP25, nsjDP50, nsjDP75];
			var nsjHP = [nsjHP25, nsjHP50, nsjHP75];
			var nsjDBP = [nsjDBP25, nsjDBP50, nsjDBP75];
			var nsj = [nsjDP, nsjHP, nsjDBP];

			var napaDP25 = [napaDP25y3, napaDP25y5, napaDP25y10];
			var napaDP50 = [napaDP50y3, napaDP50y5, napaDP50y10];
			var napaDP75 = [napaDP75y3, napaDP75y5, napaDP75y10];
			var napaHP25 = [napaHP25y3, napaHP25y5, napaHP25y10];
			var napaHP50 = [napaHP50y3, napaHP50y5, napaHP50y10];
			var napaHP75 = [napaHP75y3, napaHP75y5, napaHP75y10];
			var napaDBP25 = [napaDBP25y3, napaDBP25y5, napaDBP25y10];
			var napaDBP50 = [napaDBP50y3, napaDBP50y5, napaDBP50y10];
			var napaDBP75 = [napaDBP75y3, napaDBP75y5, napaDBP75y10];
			var napaDP = [napaDP25, napaDP50, napaDP75];
			var napaHP = [napaHP25, napaHP50, napaHP75];
			var napaDBP = [napaDBP25, napaDBP50, napaDBP75];
			var napa = [napaDP, napaHP, napaDBP];

			var regions = [cc, sonoma, lake, nsj, napa];
			// /table data declaration

			var tableparams = [];
			var inputs = [];
			var outputs = [];
			var inputkeys = [];
			inputkeys = ['dbp', 'hp', 'dp', '25', '50', '75', '3', '5', '10'];
			for (var inputindex in inputkeys) {
				inputs[inputkeys[inputindex]] = false;
			};
			var outputkeys = [];
			outputkeys = ['dcnr', 'aanr', 'lpy', 'bea'];
			for (var outputindex in outputkeys) {
				outputs[outputkeys[outputindex]] = false;
			};

			var theFormDrivenOutputVarsArray = [];
			var a=0;

			$('input[name=practicetable]:checked').each(function() {
				var thisPractice = $(this).val().toUpperCase();
				$('input[name=efficacytable]:checked').each(function() {
					var thisEfficacy = $(this).val();
					$('input[name=adoptiontable]:checked').each(function() {
						var thisYear = 'y' + $(this).val();
						var theFormDrivenOutputVarName = $('select[name=region]').val() + thisPractice + thisEfficacy + thisYear;
						theFormDrivenOutputVarsArray[a] = eval(theFormDrivenOutputVarName);
						a++;
					});
				});
			});

			console.log(theFormDrivenOutputVarsArray.length);
			var table = '';
			if ( theFormDrivenOutputVarsArray.length != 0 && $('input[name=outputtable]:checked').length != 0 ) {
				tableparams['inputs'] = inputs;
				tableparams['outputs'] = outputs;
				$('input[name$=table]:checked').each(function() {
					var element = $(this).attr('value');
					if ( $(this).attr('name') == 'outputtable' )
						tableparams.outputs[element] = true;
					else
						tableparams.inputs[element] = true;
				});

				var tablelabels = '';
				var tablerows = [];

				var the_input_keys = Object.keys(tableparams.inputs);
				var the_output_keys = Object.keys(tableparams.outputs);
				for (var j=0; j<theFormDrivenOutputVarsArray.length; j++) {
					tablerows[j] = '<tr><td>' + theFormDrivenOutputVarsArray[j][0] + '</td><td>' + theFormDrivenOutputVarsArray[j][1] + '</td><td>' + theFormDrivenOutputVarsArray[j][2] + '</td><td>' + theFormDrivenOutputVarsArray[j][3] + '</td>';
				}
				var i=0;
				for ( var param in tableparams.outputs ) {
					var the_key = the_output_keys[i];
					if ( tableparams.outputs[the_key] == true ) {
						tablelabels += '<td>' + tableHeaders[4+i] + '</td>';
						for (var j=0; j<theFormDrivenOutputVarsArray.length; j++) {
							tablerows[j] += '<td>' + theFormDrivenOutputVarsArray[j][4+i] + '</td>';
						}				
					}
					i++;
				};
				for (var j=0; j<theFormDrivenOutputVarsArray.length; j++) {
					tablerows[j] += '</tr>';
				}

				tablelabels = '<tr><td>' + tableHeaders[0] + '</td><td>' + tableHeaders[1] + '</td><td>' + tableHeaders[2] + '</td><td>' + tableHeaders[3] + '</td>' + tablelabels + '</tr>';

				table = '<h3>Output table</h3><table>' + tablelabels;
				for (var row=0; row<tablerows.length; row++) {
					table += tablerows[row];
				}
				table += '</table>';
			} else {
				table = '<p class="alert">The <em>Generate table</em> option is selected, but insufficient parameters were selected to produce an output table. To generate a table, please return to the <a href="#" onclick="console.log(\'click\'); $(\'body\').stop().animate({scrollTop: $(\'#tableparameters\').offset().top - $(\'header\').height()}, \'500\', \'swing\'); return false;">table parameters form</a> and select at least one management practice, efficacy level, year of adoption, and output parameter.</p>';
			};

		/***** Generate assumptions table
		------------------------------------ */

		var assumptionsHeaders = ['REGION', 'Price', 'Cultivar', 'Additional Cost from Double Pruning per acre', 'Additional Cost from Handpainting TopsinM per acre', 'Cultural Cost - Year 0 - Establishing Vineyard', 'Cultural Cost - Year 1 - Establishing Vineyard', 'Cultural Cost - Year 2 - Establishing Vineyard', 'Cultural Cost - Year 3+ Established Vineyard'];
		var assumptionsNapa = ['Napa', '$5,192', 'Cabernet Sauvignon', '478', '71', '$32,303', '$5,264', '$5,304', '$7,784'];
		var assumptionsNSJ = ['Northern San Joaquin', '$650', 'Cabernet Sauvignon', '175', '45', '$12,213', '$3,370', '$1,004', '$3,505'];
		var assumptionsCC = ['Central Coast', '$1,262', 'Cabernet Sauvignon', '243', '90', '$9,998', '$2,554', '$3,501', '$4,625'];
		var assumptionsLake = ['Lake', '$1,623', 'Cabernet Sauvignon', '268', '117', '$7,301', '$6,942', '$3,252', '$3,404'];
		var assumptionsSonoma = ['Sonoma', '$2,355', 'Cabernet Sauvignon', '335', '74', '$26,780', '$4,204', '$5,186', '$6,280'];		
		var assumptionsArray = [{sonoma: assumptionsSonoma, nsj: assumptionsNSJ, cc: assumptionsCC, lake: assumptionsLake, napa: assumptionsNapa}];
		var assumptionstable = '<h3>Parameter Values Used in Calculations</h3><table class="assumptionstable">';
		for (var i=0; i<assumptionsHeaders.length; i++) {
			assumptionstable += '<tr><td>' + assumptionsHeaders[i] + '</td><td>' + assumptionsArray[0][$('select[name=region]').val()][i] + '</td></tr>';
		};
		assumptionstable += '</table>';

		/***** Collate results
		------------------------------------ */

		var results = assumptionstable + '<p><a href="#page" onclick="$(\'body\').animate({scrollTop: $(\'#theform\').offset().top - $(\'header\').height()}, \'500\', \'swing\');">Adjust parameters</a></p>';
		if (tablestate == true)
			results = table + results;
		if (figurestate == true)
			results = fullfig + results;
		$('.results').html(results); // Write results to page

		/***** Style figure output width and jump to top of figs
		------------------------------------ */
		var figsAcross=1;
		if ( $('input[name=efficacyfig]:checked').length > 1 ) {
			figsAcross = $('input[name=efficacyfig]:checked').length;
		} else if ( $('input[name=practicefig]:checked').length > 1 && $('input[name=figuredisplay]').val() == 'netreturns' ) {
			figsAcross = $('input[name=practicefig]:checked').length;
		}
		if ( $( window ).width() / figsAcross < 910 ) {
			$('.results img').each(function() {
				$(this).css('width', 100/figsAcross - 1 + '%');
			})
		};
		$('body').animate({scrollTop: $('#results').offset().top - $('header').height()}, '500', 'swing');
	});
})
</script>

</body>
</html>